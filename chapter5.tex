\chapter{遅延聴覚フィードバックが身体運動に与える影響の評価方法}
本章では，遅延聴覚フィードバックが身体運動に与える影響の評価方法について述べる．
4章で説明した方法に従い，被験者がボタンを押下する時間を記録すると，被験者に提示するボタンの押下の時間間隔が毎分60回，即ち1000[ms]の間隔でボタンが押下されることが理想である．
しかし，実際には人のボタン押下時間間隔にはばらつきが生じると考えられる．
遅延聴覚フィードバックが身体運動に影響を与える場合，このばらつきは聴覚フィードバックの遅延時間の大きさに応じて変化すると予想される．
そこで，このボタン押下の時間間隔のばらつきを各遅延時間で評価することにより，遅延聴覚フィードバックが身体運動に与える影響を評価する．
ばらつきの評価には，分散と平均二乗誤差を使用し，これらの指標が大きくなるほどばらつきが大きいと判断する．
評価指標を算出する際には，評価指標の値の時間変化や使用するデータの個数が結果に影響を与えるため，
これらをパラメータとして考慮する．
\section{分散}
ボタンを押下する時間間隔の不偏分散$s^2_{a}$は，被験者が行うボタン押下の時間間隔を用いて算出する．$s^2_{a}$は，以下の式により示される．
\begin{equation}
  s^2_a = \frac{1}{l-1} \sum_{i=k}^{k+l-1} (x_i - \bar{x}_{kl})^2
\end{equation}
ここで$l$[回]は分散を算出するために使用するデータの個数，$k$は分析するデータの最初のインデックス，$x_{i}$[ms]は，取得した$i$番目のボタンの押下時間間隔のデータ，$\bar{x}_{kl}$[ms]は，$k$番目のデータから$l$個のデータを用いて算出するボタンの押下時間間隔のデータの平均値を指す．
$s^2_{a}$において，任意の$i$で理想的な時刻にボタンが押下されなかった場合，
$x_{i}$と$x_{i+1}$の両方に理想的なボタンの押下時間間隔との差異が生じる．データの平均値との差異を分析する際，大きな誤差が発生した場合，その影響で分散が過大になり，適切な評価が困難になる可能性がある．
この場合，各被験者のボタンの押下時間間隔のデータの中央値を真値とする分散を検討することが有効である．
中央値を真値として用いることにより，データに極端な誤差が生じた場合でも、ボタンの押下時間間隔のばらつきを適切に評価することが可能になると考えられる．
各被験者のボタンの押下時間間隔のデータの中央値を真値とする分散$s^2_{b}$は，以下の式により示される．
\begin{equation}
  s^2_b = \frac{1}{l} \sum_{i=k}^{k+l-1} (x_i - M_{kl})^2
\end{equation}
ここで，$M_{kl}$は，$k$番目のデータから$l$個のデータを用いて算出するボタンの押下時間間隔のデータの中央値を指す．
次に，真値を理想的なボタンの押下時間間隔とする場合を考える．例えば，ボタン押下の回数が毎分60回であれば，理想的には1000[ms]の間隔でボタンが押下される．
しかし，実際の実験では，この理想的な間隔でボタンが押下されるとは考えにくく，その理想的な間隔との誤差の分散は，
ばらつきが増加するとともに大きくなると推測される．理想的なボタンの押下時間間隔との誤差の分散$s^2_{c}$は，以下の式により示される．
\begin{equation}
  s^2_c = \frac{1}{l} \sum_{i=k}^{k+l-1} (x_i - a)^2
\end{equation}
ここで，$a$は理想的なボタンの押下時間間隔を指す．
% \section{標準偏差}
% まず，ボタンを押下する時間間隔の標準偏差$s_{1}$[ms]は，記録するボタンを押下する時間間隔を用いて算出する．$s_{1}$は次式で表される．
% \begin{equation}
%   s_1 = \sqrt{\frac{1}{n-1} \sum_{i=k}^{k+n-1} (x_i - \bar{x}_{kl})^2}
% \end{equation}
% \begin{equation}
%   s_2 = \sqrt{\frac{1}{n} \sum_{i=k}^{k+n-1} (x_i - M)^2}
% \end{equation}
% \begin{equation}
%   s_3 = \sqrt{\frac{1}{n} \sum_{i=k}^{k+n-1} (x_i - T)^2}
% \end{equation}
\section{平均二乗誤差}
本節では，聴覚フィードバックの遅延が変則的に発生する場合のばらつきの評価について検討する．
ボタンの押下回数が$t$（$t$は2以上の整数）の倍数に到達したときのみ遅延が発生する状況を想定し，$t$の倍数に到達する直前のボタン押下時間間隔と直後のボタン押下時間間隔のデータの差の平均二乗誤差（Mean Squared Error, MSE）が，
遅延聴覚フィードバックがボタン押下時間間隔に与える影響を反映すると仮定する．
遅延時間が増加するにつれて，MSEも増加すると予測される．
MSEを算出する際に用いる誤差の総数を表す関数$f(n)$と，使用するデータの最後のインデックスを示す関数$s(n)$は，
ボタンの押下回数$n$を用いて以下の式で表される．

\begin{equation}
f(n) = \left\lfloor \frac{n-t-1}{t} \right\rfloor + 1
\end{equation}
\begin{equation}
s(n) = \left\lfloor \frac{n-t-2}{t-1} \right\rfloor
\end{equation}
ここで，$\left\lfloor x \right\rfloor$は$x$を超えない最大の整数を表す．
これらの関数を用いて，MSEは次の式で定義される．
\begin{equation}
MSE = \frac{1}{f(n)} \sum_{i=0}^{s(n)} (d_{t-1+ti} - d_{t+ti})^2
\end{equation}
ここで，$d_{t-1+ti}$はボタンの押下回数が$t$の倍数に達する直前のボタン押下時間間隔，$d_{t+ti}$はボタンの押下回数が$t$の倍数に達した直後のボタン押下時間間隔のデータを示す．
これにより，聴覚フィードバックの遅延による影響を定量的に評価することが可能になると考えられる．
さらに，$t$の倍数に到達する直前のボタン押下時間間隔と到達した直後の間隔との誤差の中央値（Median Squared Error, MedSE）での評価を検討する．
この計算法により，誤差の中に極端な値が存在しても適切なばらつきの評価が行える可能性がある．
誤差の中央値MedSEは以下の式で定義される．
\begin{equation}
MedSE = Med\left((d_{t-1}-d_{t})^2, (d_{2t-1}-d_{2t})^2, \ldots, (d_{(1+s(n))t-1}-d_{(1+s(n))t})^2\right) \label{eq:MedSE}
\end{equation}
式\ref{eq:MedSE}における$Med()$は中央値を計算する関数であり，
括弧内の各項はボタンの押下回数が$t$の倍数に到達する直前のボタン押下時間間隔と$t$の倍数に到達した直後のボタン押下時間間隔の差の二乗を表す．
このように，MedSEを用いることで，データの極端なばらつきがあった場合でも，
遅延聴覚フィードバックがボタン押下時間間隔に与える影響を適切に評価することが可能になると考えられる．

% \section{絶対値誤差}
% \begin{equation}
%   MAE = \frac{1}{f(n)} \sum_{i=0}^{s(n)} |d_{3+4i} - d_{4+4i}|
% \end{equation}
